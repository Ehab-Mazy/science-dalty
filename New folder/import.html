<!-- ÙÙŠ import.html - Ø¨Ø¹Ø¯ Ù‚Ø³Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© -->
<div class="manual-upload-section">
    <h3>ğŸ“ Ø§Ù„Ø±ÙØ¹ Ø§Ù„ÙŠØ¯ÙˆÙŠ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h3>
    
    <div class="upload-options">
        <!-- Ø§Ù„Ø®ÙŠØ§Ø± 1: Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙØ§Øª Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø±ÙØ¹ -->
        <div class="upload-card">
            <h4>ğŸ› ï¸ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙØ§Øª Ù„Ù„Ø§Ø³ØªØ¶Ø§ÙØ©</h4>
            <p>Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙØ§Øª JSON Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø±ÙØ¹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©</p>
            <button class="btn btn-success" onclick="generateHostingFiles()">
                ğŸ“„ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙØ§Øª Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©
            </button>
        </div>

        <!-- Ø§Ù„Ø®ÙŠØ§Ø± 2: Ø±ÙØ¹ Ù…Ù„Ù ÙØ±Ø¯ÙŠ -->
        <div class="upload-card">
            <h4>ğŸ“¤ Ø±ÙØ¹ Ø§Ø®ØªØ¨Ø§Ø± ÙØ±Ø¯ÙŠ</h4>
            <p>Ø±ÙØ¹ Ù…Ù„Ù Ø§Ø®ØªØ¨Ø§Ø± JSON Ø¥Ù„Ù‰ Ù…Ø¬Ù„Ø¯ tests/</p>
            <div class="file-upload-area" id="singleUploadArea">
                <input type="file" id="singleTestFile" accept=".json" 
                       onchange="handleSingleFileUpload(this.files)" 
                       style="display: none;">
                <label for="singleTestFile" class="upload-label">
                    ğŸ“ Ø§Ø®ØªØ± Ù…Ù„Ù Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                </label>
                <div id="singleUploadStatus"></div>
            </div>
        </div>

        <!-- Ø§Ù„Ø®ÙŠØ§Ø± 3: Ø±ÙØ¹ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª -->
        <div class="upload-card">
            <h4>ğŸ“¦ Ø±ÙØ¹ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h4>
            <p>Ø±ÙØ¹ Ù…Ù„Ù ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</p>
            <div class="file-upload-area" id="batchUploadArea">
                <input type="file" id="batchTestsFile" accept=".json" 
                       onchange="handleBatchFileUpload(this.files)" 
                       style="display: none;">
                <label for="batchTestsFile" class="upload-label">
                    ğŸ“‚ Ø§Ø®ØªØ± Ù…Ù„Ù Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
                </label>
                <div id="batchUploadStatus"></div>
            </div>
        </div>
    </div>

    <!-- Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø© -->
    <div id="generatedFilesPreview" class="files-preview"></div>

    <!-- ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø±ÙØ¹ -->
    <div class="upload-instructions">
        <h4>ğŸ“– ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø±ÙØ¹ Ø§Ù„ÙŠØ¯ÙˆÙŠ:</h4>
        <div class="instructions-grid">
            <div class="instruction-step">
                <div class="step-number">1</div>
                <p>Ø£Ù†Ø´Ø¦ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ø¯Ø§Ø© Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯</p>
            </div>
            <div class="instruction-step">
                <div class="step-number">2</div>
                <p>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ "Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙØ§Øª Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©"</p>
            </div>
            <div class="instruction-step">
                <div class="step-number">3</div>
                <p>Ø­Ù…Ù‘Ù„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø© Ø¥Ù„Ù‰ Ù…Ø¬Ù„Ø¯ tests/ Ø¹Ù„Ù‰ Ø§Ø³ØªØ¶Ø§ÙØªÙƒ</p>
            </div>
            <div class="instruction-step">
                <div class="step-number">4</div>
                <p>Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¯Ø±ÙˆØ³</p>
            </div>
        </div>
    </div>
</div>

<style>
.manual-upload-section {
    background: #f8f9fa;
    padding: 30px;
    border-radius: 15px;
    margin: 30px 0;
    border: 2px dashed #dee2e6;
}

.upload-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin: 25px 0;
}

.upload-card {
    background: white;
    padding: 25px;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    border: 2px solid #e9ecef;
    transition: all 0.3s ease;
}

.upload-card:hover {
    border-color: #667eea;
    transform: translateY(-5px);
}

.file-upload-area {
    margin-top: 15px;
}

.upload-label {
    display: inline-block;
    background: #667eea;
    color: white;
    padding: 12px 25px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin: 10px 0;
}

.upload-label:hover {
    background: #5a67d8;
}

.files-preview {
    margin: 25px 0;
    padding: 20px;
    background: white;
    border-radius: 10px;
    border: 2px solid #e9ecef;
}

.upload-instructions {
    background: white;
    padding: 25px;
    border-radius: 10px;
    margin-top: 25px;
}

.instructions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.instruction-step {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
}

.step-number {
    width: 40px;
    height: 40px;
    background: #667eea;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1.2rem;
}

.file-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    margin: 10px 0;
    background: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #667eea;
}

.file-info {
    flex: 1;
}

.file-actions {
    display: flex;
    gap: 10px;
}

.upload-status {
    padding: 10px 15px;
    border-radius: 6px;
    margin: 10px 0;
    font-weight: 600;
}

.status-success {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.status-error {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}

.status-info {
    background: #cce7ff;
    color: #004085;
    border: 1px solid #b3d7ff;
}
</style>
<!-- Ù‚Ø³Ù… ÙØ­Øµ ÙˆØµØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª -->
<div class="validation-section">
    <h3>ğŸ” ÙØ­Øµ ÙˆØµØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h3>
    
    <div class="validation-actions">
        <button class="btn btn-warning" onclick="validateAllTests()">
            âœ… ÙØ­Øµ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
        </button>
        <button class="btn btn-info" onclick="checkServerTests()">
            ğŸŒ ÙØ­Øµ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©
        </button>
        <button class="btn btn-secondary" onclick="generateTestReport()">
            ğŸ“Š Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
        </button>
    </div>
    
    <div id="validationResults"></div>
</div>

<script>
// ÙØ­Øµ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
function validateAllTests() {
    const savedTests = JSON.parse(localStorage.getItem('savedTests') || '{}');
    const results = [];
    
    Object.values(savedTests).forEach(test => {
        const issues = validateTest(test);
        results.push({
            test: test,
            issues: issues,
            isValid: issues.length === 0
        });
    });
    
    displayValidationResults(results);
}

// ÙØ­Øµ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©
async function checkServerTests() {
    try {
        const response = await fetch('tests/');
        if (!response.ok) {
            throw new Error('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù…Ø¬Ù„Ø¯ tests');
        }
        
        // Ù‡Ø°Ø§ Ø³ÙŠØ¹Ù…Ù„ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø®Ø§Ø¯Ù… ÙŠØ³Ù…Ø­ Ø¨Ø³Ø±Ø¯ Ø§Ù„Ù…Ù„ÙØ§Øª
        const tests = await loadServerTestsIndex();
        displayServerTestResults(tests);
        
    } catch (error) {
        document.getElementById('validationResults').innerHTML = `
            <div class="alert alert-error">
                âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©: ${error.message}
            </div>
        `;
    }
}

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¹ÙŠÙ†
function validateTest(test) {
    const issues = [];
    
    if (!test.id) issues.push('Ù…Ø¹Ø±Ù Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙÙ‚ÙˆØ¯');
    if (!test.title) issues.push('Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙÙ‚ÙˆØ¯');
    if (!test.questions || !Array.isArray(test.questions)) {
        issues.push('Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©');
    } else {
        test.questions.forEach((q, index) => {
            if (!q.text) issues.push(`Ø§Ù„Ø³Ø¤Ø§Ù„ ${index + 1}: Ø§Ù„Ù†Øµ Ù…ÙÙ‚ÙˆØ¯`);
            if (!q.options || !Array.isArray(q.options) || q.options.length !== 4) {
                issues.push(`Ø§Ù„Ø³Ø¤Ø§Ù„ ${index + 1}: Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ØºÙŠØ± ØµØ§Ù„Ø­Ø©`);
            }
            if (q.correctAnswer === undefined || q.correctAnswer < 0 || q.correctAnswer > 3) {
                issues.push(`Ø§Ù„Ø³Ø¤Ø§Ù„ ${index + 1}: Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©`);
            }
        });
    }
    
    return issues;
}

// Ø¹Ø±Ø¶ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ
function displayValidationResults(results) {
    let html = '<h4>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ:</h4>';
    
    results.forEach(result => {
        const status = result.isValid ? 'âœ…' : 'âŒ';
        html += `
            <div class="test-result ${result.isValid ? 'valid' : 'invalid'}">
                <strong>${status} ${result.test.title}</strong>
                ${result.issues.length > 0 ? `
                    <div style="color: #dc3545; font-size: 0.9rem; margin-top: 5px;">
                        ${result.issues.join(' â€¢ ')}
                    </div>
                ` : ''}
            </div>
        `;
    });
    
    document.getElementById('validationResults').innerHTML = html;
}
</script>

<style>
.validation-section {
    background: #fff3cd;
    padding: 25px;
    border-radius: 10px;
    margin: 25px 0;
    border: 2px solid #ffeaa7;
}

.validation-actions {
    display: flex;
    gap: 15px;
    margin: 20px 0;
    flex-wrap: wrap;
}

.test-result {
    padding: 15px;
    margin: 10px 0;
    border-radius: 8px;
    border-left: 4px solid;
}

.test-result.valid {
    background: #d4edda;
    border-left-color: #28a745;
}

.test-result.invalid {
    background: #f8d7da;
    border-left-color: #dc3545;
}
</style>
<script src="import.js"></script>
